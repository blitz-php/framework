var blitzphpDebugBar={toolbarContainer:null,toolbar:null,icon:null,init:function(){this.toolbarContainer=document.getElementById("toolbarContainer"),this.toolbar=document.getElementById("debug-bar"),this.icon=document.getElementById("debug-icon"),blitzphpDebugBar.createListeners(),blitzphpDebugBar.setToolbarState(),blitzphpDebugBar.setToolbarPosition(),blitzphpDebugBar.setToolbarTheme(),blitzphpDebugBar.toggleViewsHints(),blitzphpDebugBar.routerLink(),document.getElementById("debug-bar-link").addEventListener("click",blitzphpDebugBar.toggleToolbar,!0),document.getElementById("debug-icon-link").addEventListener("click",blitzphpDebugBar.toggleToolbar,!0);var e=this.toolbar.querySelector('button[data-time="'+localStorage.getItem("debugbar-time")+'"]');blitzphpDebugBar.addClass(e.parentNode.parentNode,"current"),historyLoad=this.toolbar.getElementsByClassName("blitzphp-history-load");for(var t=0;t<historyLoad.length;t++)historyLoad[t].addEventListener("click",(function(){loadDoc(this.getAttribute("data-time"))}),!0);var a=blitzphpDebugBar.readCookie("debug-bar-tab");if(document.getElementById(a)){var r=document.getElementById(a);r.style.display="block",blitzphpDebugBar.addClass(r,"active"),(a=document.querySelector("[data-tab="+a+"]"))&&blitzphpDebugBar.addClass(a.parentNode,"active")}},createListeners:function(){for(var e=[].slice.call(this.toolbar.querySelectorAll(".blitzphp-label a")),t=0;t<e.length;t++)e[t].addEventListener("click",blitzphpDebugBar.showTab,!0);var a=this.toolbar.querySelectorAll("[data-toggle]");for(t=0;t<a.length;t++)a[t].addEventListener("click",blitzphpDebugBar.toggleRows,!0)},showTab:function(){var e=document.getElementById(this.getAttribute("data-tab"));if(e){blitzphpDebugBar.createCookie("debug-bar-tab","",-1);for(var t=e.style.display,a=document.querySelectorAll("#debug-bar .tab"),r=0;r<a.length;r++)a[r].style.display="none";var l=document.querySelectorAll("#debug-bar .blitzphp-label");for(r=0;r<l.length;r++)blitzphpDebugBar.removeClass(l[r],"active");"block"!=t&&(e.style.display="block",blitzphpDebugBar.addClass(this.parentNode,"active"),blitzphpDebugBar.createCookie("debug-bar-tab",this.getAttribute("data-tab"),365))}},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},toggleRows:function(e){if(e.target){let t=e.target.closest("tr"),a=document.getElementById(t.getAttribute("data-toggle"));a.style.display="none"===a.style.display?"table-row":"none"}},toggleDataTable:function(e){"string"==typeof e&&(e=document.getElementById(e+"_table")),e&&(e.style.display="none"===e.style.display?"block":"none")},toggleChildRows:function(e){"string"==typeof e&&(par=document.getElementById(e+"_parent"),e=document.getElementById(e+"_children")),par&&e&&(e.style.display="none"===e.style.display?"":"none",par.classList.toggle("timeline-parent-open"))},toggleToolbar:function(){var e="none"!=blitzphpDebugBar.toolbar.style.display;blitzphpDebugBar.icon.style.display=1==e?"inline-block":"none",blitzphpDebugBar.toolbar.style.display=0==e?"inline-block":"none",blitzphpDebugBar.createCookie("debug-bar-state","",-1),blitzphpDebugBar.createCookie("debug-bar-state",1==e?"minimized":"open",365)},setToolbarState:function(){var e=blitzphpDebugBar.readCookie("debug-bar-state");blitzphpDebugBar.icon.style.display="open"!=e?"inline-block":"none",blitzphpDebugBar.toolbar.style.display="open"==e?"inline-block":"none"},toggleViewsHints:function(){if(localStorage.getItem("debugbar-time")!=localStorage.getItem("debugbar-time-new"))return void(document.querySelector('a[data-tab="blitzphp-views"]').href="#");var e=[],t=[],a=function(e,t){return null===e.parentNode?null:e.parentNode!==t?a(e.parentNode,t):e};const r=["NOSCRIPT","SCRIPT","STYLE"],l=["HTML","BODY","HEAD"];var o=function(e,t){if(-1!==l.indexOf(e.nodeName)){for(var a=0;a<document.body.children.length;++a){var o=t?document.body.children.length-(a+1):a,i=document.body.children[o];if(-1===r.indexOf(i.nodeName))return[i,t]}return null}for(;null!==e&&-1!==r.indexOf(e.nodeName);)e=t?e.previousElementSibling:e.nextElementSibling;return null===e?null:[e,t]},i=function(e){if(e){if(null!==e.nextElementSibling)return o(e.nextElementSibling,!1)||o(e.previousElementSibling,!0);if(null!==e.previousElementSibling)return o(e.previousElementSibling,!0)}return null};function n(){for(var l in t=function(){for(var e=[],t=[],a=document.evaluate("//comment()[starts-with(., ' DEBUG-VIEW')]",document,null,XPathResult.ANY_TYPE,null),r=a.iterateNext();r;)e.push(r),r=a.iterateNext();for(var l=0;l<e.length;++l){var o=e[l].nodeValue.substring(18,e[l].nodeValue.length-1);"S"===e[l].nodeValue[12]?t[o]=[e[l],null]:t[o]&&(t[o][1]=e[l])}return t}(),t){var o=i(t[l][0]),n=i(t[l][1]);if(null!==o&&null!==n){var d=a(n[0],o[0].parentNode);if(null===d){if(null===(d=a(o[0],n[0].parentNode)))continue;o[0]=d}else n[0]=d;var p,u,s=document.createElement("div"),g=document.createElement("div"),c=o[0].parentNode.childNodes,h=o[0].parentNode;s.classList.add("debug-view"),s.classList.add("show-view"),g.classList.add("debug-view-path"),g.innerText=l,s.appendChild(g);for(var m=0;m<c.length;++m)if(c[m]===t[l][1]||c[m]===t[l][0]||c[m]===o[0]){p=m,c[m]===t[l][0]&&p++;break}o[1]&&p++;for(m=p;m<c.length;++m)if(c[m]===n[0])u=m;else if(c[m]===t[l][1]){u=m;break}var f=u-p;n[1]&&f++;for(m=0;m<f;++m)-1===r.indexOf(c[p])?s.appendChild(c[p]):p++;e.push(h.insertBefore(s,c[p]))}}blitzphpDebugBar.createCookie("debug-view","show",365),blitzphpDebugBar.addClass(b,"active")}var b=document.querySelector("[data-tab=blitzphp-views]");b&&(b.parentNode.onclick=function(){blitzphpDebugBar.readCookie("debug-view")?function(){for(var t=0;t<e.length;++t){for(var a,r=0;r<e[t].parentNode.childNodes.length;++r)if(e[t].parentNode.childNodes[r]===e[t]){a=r;break}for(;1!==e[t].childNodes.length;)e[t].parentNode.insertBefore(e[t].childNodes[1],e[t].parentNode.childNodes[a].nextSibling),a++;e[t].parentNode.removeChild(e[t])}e.length=0,blitzphpDebugBar.createCookie("debug-view","",-1),blitzphpDebugBar.removeClass(b,"active")}():n()},blitzphpDebugBar.readCookie("debug-view")&&n())},setToolbarPosition:function(){var e=this.toolbar.querySelector("#toolbar-position");"top"===blitzphpDebugBar.readCookie("debug-bar-position")&&(blitzphpDebugBar.addClass(blitzphpDebugBar.icon,"fixed-top"),blitzphpDebugBar.addClass(blitzphpDebugBar.toolbar,"fixed-top")),e.addEventListener("click",(function(){var e=blitzphpDebugBar.readCookie("debug-bar-position");blitzphpDebugBar.createCookie("debug-bar-position","",-1),e&&"bottom"!==e?(blitzphpDebugBar.createCookie("debug-bar-position","bottom",365),blitzphpDebugBar.removeClass(blitzphpDebugBar.icon,"fixed-top"),blitzphpDebugBar.removeClass(blitzphpDebugBar.toolbar,"fixed-top")):(blitzphpDebugBar.createCookie("debug-bar-position","top",365),blitzphpDebugBar.addClass(blitzphpDebugBar.icon,"fixed-top"),blitzphpDebugBar.addClass(blitzphpDebugBar.toolbar,"fixed-top"))}),!0)},setToolbarTheme:function(){var e=this.toolbar.querySelector("#toolbar-theme");window.matchMedia("(prefers-color-scheme: dark)").matches,window.matchMedia("(prefers-color-scheme: light)").matches;"dark"===blitzphpDebugBar.readCookie("debug-bar-theme")?(blitzphpDebugBar.removeClass(blitzphpDebugBar.toolbarContainer,"light"),blitzphpDebugBar.addClass(blitzphpDebugBar.toolbarContainer,"dark")):"light"===blitzphpDebugBar.readCookie("debug-bar-theme")&&(blitzphpDebugBar.removeClass(blitzphpDebugBar.toolbarContainer,"dark"),blitzphpDebugBar.addClass(blitzphpDebugBar.toolbarContainer,"light")),e.addEventListener("click",(function(){var e=blitzphpDebugBar.readCookie("debug-bar-theme");!e&&window.matchMedia("(prefers-color-scheme: dark)").matches||"dark"===e?(blitzphpDebugBar.createCookie("debug-bar-theme","light",365),blitzphpDebugBar.removeClass(blitzphpDebugBar.toolbarContainer,"dark"),blitzphpDebugBar.addClass(blitzphpDebugBar.toolbarContainer,"light")):(blitzphpDebugBar.createCookie("debug-bar-theme","dark",365),blitzphpDebugBar.removeClass(blitzphpDebugBar.toolbarContainer,"light"),blitzphpDebugBar.addClass(blitzphpDebugBar.toolbarContainer,"dark"))}),!0)},createCookie:function(e,t,a){if(a){var r=new Date;r.setTime(r.getTime()+24*a*60*60*1e3);var l="; expires="+r.toGMTString()}else l="";document.cookie=e+"="+t+l+"; path=/; samesite=Lax"},readCookie:function(e){for(var t=e+"=",a=document.cookie.split(";"),r=0;r<a.length;r++){for(var l=a[r];" "==l.charAt(0);)l=l.substring(1,l.length);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return null},trimSlash:function(e){return e.replace(/^\/|\/$/g,"")},routerLink:function(){for(var e,t,a=this.toolbar.querySelectorAll('td[data-debugbar-route="GET"]'),r=/\((?:[^)(]+|\((?:[^)(]+|\([^)(]*\))*\))*\)/,l=0;l<a.length;l++)e=a[l],/\/\(.+?\)/.test(a[l].innerText)?e.innerHTML="<div>"+e.innerText+'</div><form data-debugbar-route-tpl="'+blitzphpDebugBar.trimSlash(e.innerText.replace(r,"?"))+'">'+e.innerText.replace(r,'<input type="text" placeholder="$1">')+'<input type="submit" value="Go" style="margin-left: 4px;"></form>':(e.style="cursor: pointer;",e.setAttribute("title",location.origin+"/"+blitzphpDebugBar.trimSlash(e.innerText)),e.addEventListener("click",(function(e){t=location.origin+"/"+blitzphpDebugBar.trimSlash(e.target.innerText),window.open(t,"_blank").location})));a=this.toolbar.querySelectorAll('td[data-debugbar-route="GET"] form');for(l=0;l<a.length;l++)(e=a[l]).addEventListener("submit",(function(e){e.preventDefault();for(var a=[],r=0,l=e.target.querySelectorAll("input[type=text]"),o=e.target.getAttribute("data-debugbar-route-tpl"),i=0;i<l.length;i++)l[i].value.length>0&&a.push(l[i].value);a.length>0&&(t=location.origin+"/"+o.replace(/\?/g,(function(){return a[r++]})),window.open(t,"_blank").location)}))}};